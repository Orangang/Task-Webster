<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Task Webster · Вход</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
/* ===== Дизайн-токены (mobile-first, брейкпоинты Tilda 320/480/640/960) */
:root{
  --bg:#F5F7FB; --shell:#fff; --text:#0B1220; --muted:#6B7380;
  --line:#E6E9F0; --line-strong:#D6DAE3;
  --primary:#0B82DD; --primary-ink:#fff;
  --shadow-1:0 12px 32px rgba(12,22,44,.08);
  --fs-xs:clamp(11px,.78vw,12px);
  --fs-sm:clamp(12px,.9vw,14px);
  --fs-md:clamp(14px,1.05vw,16px);
  --fs-lg:clamp(16px,1.25vw,18px);
  --radius:12px; --radius-lg:16px;
}
*{box-sizing:border-box} html,body{height:100%}
body{margin:0;background:var(--bg);color:var(--text);font:400 var(--fs-md)/1.5 "Inter",system-ui}

/* ===== Layout */
.shell{min-height:100vh;display:grid;grid-template-columns:1fr;place-items:stretch}
@media (min-width:960px){.shell{grid-template-columns:520px 1fr}}
.left{display:flex;align-items:center;justify-content:center;padding:24px}
.right{display:none}
@media (min-width:960px){
  .right{display:block;position:relative;overflow:hidden}
  .right::before{
    content:""; position:absolute; inset:0;
    background:
      radial-gradient(1200px 600px at 110% -10%, rgba(11,130,221,.24), transparent 60%),
      radial-gradient(900px 500px at -10% 110%, rgba(94,200,255,.24), transparent 60%),
      linear-gradient(180deg,#0b1220,#0b1220);
  }
  .hero{
    position:absolute; inset:0;
    background-image:url('https://i.pinimg.com/1200x/79/fd/31/79fd318dc69d9bdaa0e45ae082916ff2.jpg?q=80&w=1600&auto=format&fit=crop');
    background-size:cover; background-position:center;
    opacity:.22; filter:contrast(110%) saturate(105%);
  }
  .hero-slot{position:absolute;inset:0;display:grid;place-items:end start;padding:32px;color:#eaeef7}
  .hero-slot h3{margin:0 0 6px;font-weight:600}
  .hero-slot p{margin:0;opacity:.9;font-size:var(--fs-sm)}
}

/* ===== Card */
.card{
  width:min(420px,100%); background:var(--shell); border:1px solid var(--line);
  border-radius:var(--radius-lg); box-shadow:var(--shadow-1); padding:22px;
}
.header{display:flex;align-items:center;gap:12px;margin-bottom:8px}
.logo{width:36px;height:36px;border-radius:10px;background:linear-gradient(135deg,#7aa7ff,#5ec8ff)}
h1{margin:0;font-size:var(--fs-lg)}
.slogan{color:var(--muted);font-size:var(--fs-sm)}

/* Tabs */
.tabs{display:flex;gap:8px;margin:12px 0}
.tab{
  padding:6px 10px;border:1px solid var(--line);border-radius:10px;background:#fff;
  font-weight:600;cursor:pointer;font-size:var(--fs-sm)
}
.tab.active{border-color:#b9d6ff;background:#eef6ff}

/* Form */
.form{display:flex;flex-direction:column;gap:12px}
.input{display:flex;flex-direction:column;gap:6px}
.input label{font-size:var(--fs-sm);color:var(--muted)}
.input input{
  padding:10px 12px;border-radius:10px;border:1px solid var(--line-strong);
  background:#fff;outline:none
}
.input input:focus{border-color:#b9d6ff;box-shadow:0 0 0 3px rgba(11,130,221,.12)}
.row{display:flex;justify-content:space-between;align-items:center;gap:12px}
.chk{display:flex;align-items:center;gap:8px;font-size:var(--fs-sm);color:var(--muted)}
a.link{color:#0B82DD;text-decoration:none} a.link:hover{text-decoration:underline}

/* Buttons */
.btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;
  padding:10px 14px;border:1px solid var(--line-strong);border-radius:12px;background:#fff;
  font-weight:600;cursor:pointer}
.btn.primary{background:var(--primary);color:var(--primary-ink);border-color:transparent}
.btn.block{width:100%}

/* Messages */
.msg{display:none;margin-top:6px;padding:8px 10px;border-radius:10px;border:1px solid var(--line);font-size:var(--fs-sm)}
.msg.ok{display:block;background:#ecfff0;border-color:#c6f3d2;color:#176c34}
.msg.err{display:block;background:#fff0f0;border-color:#ffd1d1;color:#8b1e1e}

/* Footer */
.footer{margin-top:16px;color:var(--muted);font-size:var(--fs-sm);display:flex;justify-content:space-between;gap:12px}
.footer a{color:inherit;text-decoration:none} .footer a:hover{text-decoration:underline}
</style>
</head>
<body>
<div class="shell">
  <!-- LEFT: форма -->
  <section class="left">
    <div class="card" role="dialog" aria-modal="true">
      <div class="header">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>Task Webster</h1>
          <div class="slogan">Некультурные задачи для культурных людей</div>
        </div>
      </div>

      <!-- Tabs -->
      <div class="tabs" role="tablist" aria-label="Режим">
        <button id="tab-login"  class="tab active" aria-controls="pane-login"  aria-selected="true">Вход</button>
        <button id="tab-signup" class="tab"         aria-controls="pane-signup" aria-selected="false">Регистрация</button>
        <button id="tab-reset"  class="tab"         aria-controls="pane-reset"  aria-selected="false">Сброс пароля</button>
      </div>

      <!-- ВХОД -->
      <form id="pane-login" class="form" role="tabpanel" aria-labelledby="tab-login">
        <div class="input">
          <label for="login-email">Email</label>
          <input id="login-email" type="email" autocomplete="username" placeholder="you@studio.com" required>
        </div>
        <div class="input">
          <label for="login-pass">Пароль</label>
          <input id="login-pass" type="password" autocomplete="current-password" placeholder="••••••••" required>
        </div>
        <div class="row">
          <label class="chk"><input id="remember" type="checkbox"> Запомнить меня</label>
          <a href="#" class="link" id="link-forgot">Забыли пароль?</a>
        </div>
        <button type="submit" class="btn primary block">Войти</button>
        <div id="loginMsg" class="msg"></div>
        <div class="row" style="justify-content:center;font-size:var(--fs-sm)">
          Нет аккаунта? <a href="#" id="to-signup" class="link">Создать аккаунт</a>
        </div>
      </form>

      <!-- РЕГИСТРАЦИЯ -->
      <form id="pane-signup" class="form" role="tabpanel" aria-labelledby="tab-signup" hidden>
        <div class="input">
          <label for="signup-email">Email</label>
          <input id="signup-email" type="email" autocomplete="username" placeholder="you@studio.com">
        </div>
        <div class="input">
          <label for="signup-pass">Пароль</label>
          <input id="signup-pass" type="password" autocomplete="new-password" placeholder="минимум 6 символов">
        </div>
        <button type="submit" class="btn primary block">Создать аккаунт</button>
        <div id="signupMsg" class="msg"></div>
        <div class="row" style="justify-content:center;font-size:var(--fs-sm)">
          Уже есть аккаунт? <a href="#" id="to-login" class="link">Войти</a>
        </div>
      </form>

      <!-- СБРОС -->
      <form id="pane-reset" class="form" role="tabpanel" aria-labelledby="tab-reset" hidden>
        <div class="input">
          <label for="reset-email">Email</label>
          <input id="reset-email" type="email" autocomplete="username" placeholder="you@studio.com">
        </div>
        <button type="submit" class="btn block">Отправить ссылку на сброс</button>
        <div id="resetMsg" class="msg"></div>
      </form>

      <div class="footer" aria-label="Нижняя полоса">
        <div>© 2025 · Webster</div>
        <div><a href="#">Политика конфиденциальности</a> · <a href="#">Пользовательское соглашение</a></div>
      </div>
    </div>
  </section>

  <!-- RIGHT: изображение/герой -->
  <section class="right" aria-hidden="true">
    <div class="hero"></div>
    <div class="hero-slot">
      <div>
        <h3>Task Webster</h3>
        <p>Современный Task Manager для веб-студии. Управляй проектами, задачами и сроками.</p>
      </div>
    </div>
  </section>
</div>

<!-- Supabase -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.45.4/dist/umd/supabase.js"></script>
<script>
/* === Конфиг Supabase (твой проект) === */
const SUPABASE_URL="https://aayobnsqgzsmhwbtutyw.supabase.co";
const SUPABASE_ANON_KEY="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFheW9ibnNxZ3pzbWh3YnR1dHl3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE1MDkxNDEsImV4cCI6MjA3NzA4NTE0MX0.dNC_rYVPLk3etb2njI3agDE7wmmu4HQyBrkiyZ4ifoA";
const supa = window.supabase.createClient(SUPABASE_URL,SUPABASE_ANON_KEY);

/* === Табы === */
const panes={login:document.getElementById('pane-login'),signup:document.getElementById('pane-signup'),reset:document.getElementById('pane-reset')};
const tabs ={login:document.getElementById('tab-login'),signup:document.getElementById('tab-signup'),reset:document.getElementById('tab-reset')};
function act(name){Object.keys(panes).forEach(k=>{panes[k].hidden=(k!==name);tabs[k].classList.toggle('active',k===name);tabs[k].setAttribute('aria-selected',k===name?'true':'false');});}
tabs.login.onclick=()=>act('login'); tabs.signup.onclick=()=>act('signup'); tabs.reset.onclick=()=>act('reset');
document.getElementById('to-signup').onclick=(e)=>{e.preventDefault();act('signup');};
document.getElementById('to-login').onclick =(e)=>{e.preventDefault();act('login');};
document.getElementById('link-forgot').onclick=(e)=>{e.preventDefault();act('reset');};

/* === Сообщения === */
const M={login:document.getElementById('loginMsg'), signup:document.getElementById('signupMsg'), reset:document.getElementById('resetMsg')};
const show=(el,t,txt)=>{el.className='msg '+t; el.textContent=txt; el.style.display='block';};
const hide=(el)=>{el.style.display='none'; el.textContent='';};

/* === Remember me: сохраняем только email для автоподстановки === */
const emailKey='tw_email';
const remember=document.getElementById('remember');
const loginEmail=document.getElementById('login-email');
const savedEmail=localStorage.getItem(emailKey); if(savedEmail){ loginEmail.value=savedEmail; remember.checked=true; }

/* === Вход === */
document.getElementById('pane-login').addEventListener('submit',async(e)=>{
  e.preventDefault(); hide(M.login);
  const email=loginEmail.value.trim();
  const pass =document.getElementById('login-pass').value;
  try{
    const { data, error } = await supa.auth.signInWithPassword({ email, password: pass });
    if(error) throw error;
    if(remember.checked) localStorage.setItem(emailKey,email); else localStorage.removeItem(emailKey);
    localStorage.setItem('tw_user', JSON.stringify({ id:data.user.id, email }));
    location.href='./index.html';
  }catch(err){ show(M.login,'err','Ошибка входа: '+err.message); }
});

/* === Регистрация с авто-входом === */
document.getElementById('pane-signup').addEventListener('submit',async(e)=>{
  e.preventDefault(); hide(M.signup);
  const email=document.getElementById('signup-email').value.trim();
  const pass =document.getElementById('signup-pass').value;
  if(!email||!pass) return show(M.signup,'err','Укажите e-mail и пароль (≥6).');
  try{
    const { error:e1 } = await supa.auth.signUp({ email, password: pass }); if(e1) throw e1;
    const { data, error:e2 } = await supa.auth.signInWithPassword({ email, password: pass }); if(e2) throw e2;
    localStorage.setItem('tw_user', JSON.stringify({ id:data.user.id, email }));
    location.href='./index.html';
  }catch(err){ show(M.signup,'err','Ошибка регистрации: '+err.message); }
});

/* === Сброс пароля === */
document.getElementById('pane-reset').addEventListener('submit',async(e)=>{
  e.preventDefault(); hide(M.reset);
  const email=document.getElementById('reset-email').value.trim();
  if(!email) return show(M.reset,'err','Укажите e-mail.');
  try{
    const { error } = await supa.auth.resetPasswordForEmail(email,{ redirectTo: location.origin + location.pathname });
    if(error) throw error;
    show(M.reset,'ok','Ссылка на сброс отправлена на '+email);
  }catch(err){ show(M.reset,'err','Не удалось отправить: '+err.message); }
});
</script>
</body>
</html>
